# Double Elimination Bracket - Explained

## What is Double Elimination?

Double elimination is a tournament format where a team must **lose TWICE** to be eliminated. This gives teams a second chance after their first loss.

It's perfect for competitive tournaments because:
- ğŸ† True champion emerges
- âš–ï¸ Fair - one bad match doesn't eliminate you
- ğŸ“Š Determines positions 1-4 accurately
- ğŸ® More matches = more playtime

---

## How It Works - Visual Example

### Tournament with 4 Teams (A, B, C, D)

#### **Winners Bracket** (For Undefeated Teams)
```
Round 1:          Round 2 (Finals):
A â”€â”
   â”œâ”€ Winner1 â”€â”
B â”€â”˜           â”‚
               â”œâ”€ Champions
C â”€â”           â”‚
   â”œâ”€ Winner2 â”€â”˜
D â”€â”˜
```

**Winners Bracket Result:** 
- Winner1 = 1ï¸âƒ£ Champion (wins without losing)
- Winner2 = undefeated finalist

---

#### **Losers Bracket** (For Beaten Teams)
```
Loser1 (from Winners R1)
     â”œâ”€ Losers Bracket Winner
Loser2 (from Winners R1)
```

**Losers Bracket Result:**
- Losers champion goes to Grand Final

---

#### **Grand Final** (Championship)
```
Winners Bracket Champion vs Losers Bracket Champion
```

**Final Results:**
- ğŸ¥‡ 1st Place: Grand Final Winner
- ğŸ¥ˆ 2nd Place: Grand Final Loser
- ğŸ¥‰ 3rd/4th Place: Determined by losers bracket

---

## Real Tournament With 8 Teams

### Full Bracket Flow

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    TOURNAMENT BRACKET (8 Teams)               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

================== WINNERS BRACKET ==================

Round 1:              Round 2:            Round 3:
Team A â”‚             â”‚                    â”‚
       â”œâ”€ W1 â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
Team B â”‚             â”‚                    â”‚
                     â”œâ”€ W3 â”€â”€â”€â”€â”€â”€â”€â”       â”‚
Team C â”‚             â”‚            â”‚       â”‚
       â”œâ”€ W2 â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”œâ”€ W5 â”€â”€â”¤
Team D â”‚             â”‚            â”‚       â”‚
                     â”œâ”€ W4 â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
Team E â”‚             â”‚                    â”‚
       â”œâ”€ W6 â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
Team F â”‚             â”‚                    â”‚
                                          â”‚
                                 (Winners Final)
Team G â”‚                          â”‚
       â”œâ”€ W7 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
Team H â”‚

       â””â”€ Losers from Round 1 & 2 go to Losers Bracket â”€â”
                                                        â”‚
================== LOSERS BRACKET ==================  â”‚
                                                    â†“
L1 (L from W1) â”‚                          â”‚
               â”œâ”€ LW1 â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
L2 (L from W2) â”‚              â”‚           â”‚
                              â”œâ”€ LW3 â”€â”€â”  â”‚
L3 (L from W3) â”‚              â”‚        â”‚  â”‚
               â”œâ”€ LW2 â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚  â”‚
L4 (L from W4) â”‚              â”‚        â”‚  â”‚
                              â”œâ”€ LW4 â”€â”€â”¤  â”‚
         (More losers...)                 â”‚
                                          â”‚
                           (Losers Final) â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
================== GRAND FINAL ==================
                                    â”‚
        Winners Champion (W5) â”€â”€â”€â”  â”‚
                                â”‚  â”‚
                                â”œâ”€ GRAND WINNER = 1st Place
                                â”‚  â”‚
   Losers Champion (LW4) â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                    â”‚
                    If Losers wins â”€â”€â†’ Must play again!
                    (Best of all formats)
```

---

## Tournament Positions (8 Teams Example)

After all matches:

| ğŸ† Position | ğŸ“ Path | ğŸ¯ Achievement |
|-----------|--------|--------------|
| **1st** | Won Winners Finals â†’ Won Grand Final | Undefeated or beat finals opponent |
| **2nd** | Lost Winners Finals OR won Losers Finals | Lost only in championship |
| **3rd** | Lost Losers Finals | Lost twice, but made it far |
| **4th** | Lost early in Losers Bracket | Lost twice early |

---

## With Bye Matches (Non-Power-of-2 Teams)

### 5 Teams (Not power of 2 = 2Â²=4, next is 2Â³=8)

```
Seeding by ELO (highest gets bye):

Round 1:
Team A (Bye) â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚
Team B â”€â”€â”           â”‚
         â”œâ”€ W1 â”€â”€â”€â”€â”€â”€â”¤
Team C â”€â”€â”˜           â”‚
                     â”œâ”€ W3
Team D â”€â”€â”           â”‚
         â”œâ”€ W2 â”€â”€â”€â”€â”€â”€â”¤
Team E â”€â”€â”˜

Team A advances WITHOUT PLAYING (bye)
```

**Why?** With 5 teams,  we need only 2 matches to get 4 teams for the next round:
- Match 1: Teams B vs C â†’ 1 winner
- Match 2: Teams D vs E â†’ 1 winner  
- Team A gets bye
- Next round: A, W1, W2, and... (we need 4 but only have 3)

So higher-ranked teams (by ELO) get byes in Round 1 to make 8 spots eventually.

---

## Rewards Distribution

Based on final positions:

| Position | ğŸ… Medal | ğŸ’° Coins (per player) | Example |
|----------|---------|-------|---------|
| 1st | ğŸ¥‡ Gold | 500,000 | Team A (2 players) = 1,000,000 coins total |
| 2nd | ğŸ¥ˆ Silver | 300,000 | Team B (2 players) = 600,000 coins total |
| 3rd | ğŸ¥‰ Bronze | 200,000 | Team C (2 players) = 400,000 coins total |
| 4th | - | 50,000 | Team D (2 players) = 100,000 coins total |

---

## Key Features in Your Implementation

### âœ… Bye Matches
- Automatically generated for non-power-of-2 counts
- High ELO teams get byes (seeded advantage)
- Marked as "finished" automatically

### âœ… Three Brackets
- **Winners Bracket:** Undefeated teams only
- **Losers Bracket:** Teams with 1 loss
- **Grand Final:** Champions from each bracket

### âœ… Dynamic Seeding
- Teams seed by their **average team ELO**
- Average = (Player1 ELO + Player2 ELO) / 2
- Prevents completely new players facing champions in round 1

### âœ… Match Flow
```
State Progression:
waiting â†’ playing â†’ finished

Visual Indicators:
â³ Waiting  = Gray, selectable
âš¡ Playing  = Orange, in progress
âœ“ Finished = Green, shows score and winner
```

### âœ… ELO Display
Each match card shows:
- Average Team ELO
- Both players' individual ELO
- Team member names

---

## Example Tournament Progression

### Scenario: 6 Teams

**Setup:** 1 bye match (8 slots - 6 teams = 2 byes)

**Round 1 (Winners):**
```
Team A: 600 ELO (bye)
Team B: 580 ELO (bye)
Team C: 550 ELO vs Team D: 520 ELO
Team E: 480 ELO vs Team F: 450 ELO
```
â†’ Winners: A, B, C-winner, E-winner

**Round 2 (Winners):**
```
A vs B
C-winner vs E-winner
```
â†’ Final winners: W1, W2

**Losers Bracket (for losers):**
```
D vs F (from Winners R1)
â†’ LW1

LW1 vs C-loser or E-loser (from Winners R2)
â†’ Finals loser

Losers Final â†’ LW2
```

**Grand Final:**
```
W1 vs LW2
```

---

## FAQ

**Q: What if I lose in the Grand Final but I won Winners Bracket?**
A: You're 2nd place. Losers bracket winner beat you in the final, so they're 1st. You lost only once (at the end).

**Q: What if both me and my partner are eliminated?**
A: You're out! Double elimination means lose TWICE to stay alive. But losing twice takes at least 2 matches for each of you.

**Q: Do tournament matches count toward my ELO rank?**
A: No! Tournament matches are for fun/prizes only. Your ranked ELO stays the same.

**Q: Why do bye matches matter?**
A: They keep brackets balanced. With 5 teams, someone would wait forever. Bye = "beat someone who didn't show" = advances.

**Q: Can the Grand Final winner be from the Losers Bracket?**
A: Absolutely! If they win the Losers Bracket, they earn the right to play the Winners Bracket champ. If they win THAT match, they're #1.

---

## Implementation in Your Code

Main function: **`generateDoubleEliminationBracket(teams)`**

Located in: `src/logic/tournament.ts`

**What it does:**
1. Takes all **locked teams**
2. Seeds by ELO (highest first)
3. Calculates bye count
4. Creates Winners Bracket matches
5. Creates Losers Bracket matches
6. Creates Grand Final match
7. Returns all matches organized by bracket

**Output:** Array of TournamentMatch objects with:
- `bracket`: "winners" | "losers" | "final"
- `round`: 1, 2, 3, etc.
- `position`: Position in round (for ordering)
- `isBye`: true for automatic winner matches
- `team1Id` and `team2Id`: Team references

---

Enjoy your tournament system! ğŸ®âš¡
